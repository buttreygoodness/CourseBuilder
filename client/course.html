<template name="course">
  <div class="container">
    {{#if showCreateBlockDialog}}
      {{> createBlockDialog}}
    {{/if}}
    {{#if course}}
      {{#with course}}
      <div class="row">
        <div class="span12">
          <h1>{{title}} <small>{{_id}}</small>  {{> courseControls}}</h1>
        </div>
      </div>
      <div class="row">
        <div class="span3">
          <div class="well">
            <ul>
              {{#if anyChapters}}
                {{#each chapters}}
                  <li>{{title}}</li>
                {{/each}}
              {{/if}}
            </ul>
          </div>
        </div>
        <div class="span9">
          {{#if showCreateChapterDialog}}
            {{> createChapterDialogInline}}
          {{/if}}
          {{#if anySections}}
            {{#each sections}}
              {{> module_section}}
            {{/each}}
          {{/if}}
          {{#if anyChapters}}
            {{#each chapters}}
              {{> module_chapter}}
            {{/each}}
          {{else}}
            <div class="well">
              Get started by adding some chapters.
            </div>
          {{/if}}
        </div>
      </div>
      {{/with}}
    {{/if}}
  </div>
</template>

<template name="module_chapter">
  <section class="chapter" id="{{_id}}">
    <h2>{{title}} {{#if selected}}<small>{{_id}}</small> {{> chapterControls}}{{/if}}</h2>
    {{#if showCreateSectionDialog}}
      {{> createSectionDialogInline}}
    {{/if}}
    {{#if anySections}}
      {{#each sections}}
        {{> module_section}}
      {{/each}}
    {{/if}}
  </section>
</template>

<template name="module_section">
  <section class="section" id="{{_id}}">
    <h3>{{title}} {{#if selected}}<small>{{_id}}</small> {{> sectionControls}}{{/if}}</h3>
    {{#if anyBlocks}}
      {{#each blocks}}
        {{> block_text}}
      {{/each}}
    {{/if}}
  </section>
</template>

<template name="block_text">
  <div>
    <h4>{{title}}</h4>
    <p>{{body}}</p>
  </div>
</template>

<template name="courseControls">
  <a href="#" class="btn btn-small createChapter">Add Chapter</a>
  <a href="#" class="btn btn-small createSection">Add Section</a>
  <a href="#" class="btn btn-small">Add Block</a>
</template>

<template name="chapterControls">
  <a href="#" class="btn btn-small createSection">Add Section</a>
  <!-- <a href="#" class="btn btn-small createBlock">Add Block</a> -->
</template>

<template name="sectionControls">
  <a href="#" class="btn btn-small createBlock">Add Block</a>
</template>

<template name="blockControls">
  <a href="#" class="btn btn-small edit">Edit Block</a>
</template>

<!-- createChapterDialogInline -->

<template name="createChapterDialogInline">
  
  <div class="inline-form">
    {{#if error}}
    <div class="alert alert-error">{{error}}</div>
    {{/if}}
  
    <input type="text" class="title span5" placeholder="Enter a chapter title">
  
    <div class="btn-group pull-right">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add Chapter</a>
    </div>
  </div>
  
</template>

<!-- createChapterDialogInline -->

<template name="createSectionDialogInline">
  
  <div class="inline-form">
    {{#if error}}
    <div class="alert alert-error">{{error}}</div>
    {{/if}}
  
    <input type="text" class="title span5" placeholder="Enter a chapter title">
  
    <div class="btn-group pull-right">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add Chapter</a>
    </div>
  </div>
  
</template>

<!-- createChapterDialog template -->

<template name="createChapterDialog">
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header">
      <button type="button" class="close cancel">&times;</button>
      <h3>Add Chapter</h3>
    </div>

    <div class="modal-body">
      {{#if error}}
        <div class="alert alert-error">{{error}}</div>
      {{/if}}

      <label>Title</label>
      <input type="text" class="title span5">

    </div>

    <div class="modal-footer">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add Chapter</a>
    </div>
  </div>
</template>

<!-- createSectionDialog template -->

<template name="createSectionDialog">
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header">
      <button type="button" class="close cancel">&times;</button>
      <h3>Add Section</h3>
    </div>

    <div class="modal-body">
      {{#if error}}
        <div class="alert alert-error">{{error}}</div>
      {{/if}}

      <label>Title</label>
      <input type="text" class="title span5">

    </div>

    <div class="modal-footer">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add Section</a>
    </div>
  </div>
</template>

<!-- createBlockDialog template -->

<template name="createBlockDialog">
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header">
      <button type="button" class="close cancel">&times;</button>
      <h3>Add Block</h3>
    </div>

    <div class="modal-body">
      {{#if error}}
        <div class="alert alert-error">{{error}}</div>
      {{/if}}

      <label>Title <small>(Optional) It won't display unless you enter it.</small></label>
      <input type="text" class="title span5">
      
      <label>Body</label>
      <textarea class="body span5"></textarea>

    </div>

    <div class="modal-footer">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add Block</a>
    </div>
  </div>
</template>